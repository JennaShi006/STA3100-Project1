---
title: "Project-1"
author: "Haoran Shi and Jingyao Zhang"
date: "2024-10-17"
output: pdf_document
bibliography: references.bib
csl: apa-with-abstract.csl
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, include = FALSE}
esg.data = read.csv("sp500_esg_data.csv")


```

# Abstract ## Tina

# Introduction ## Tina

# Data
The data set selected focuses on the ESG (Environmental, Social, and Governance) scores of companies listed in the S&P 500 index. The environmental score evaluates a company’s impact on the environment, considering factors such as carbon emissions, energy consumption, and waste management. The social score assesses the company’s relationships with its employees, suppliers, customers, and the communities in which it operates. The governance score measures corporate governance practices, including executive compensation, audits, internal controls, and shareholder rights. Combined, the ESG score represents the overall risk or impact a company has across these three areas, with a lower ESG score indicating a more positive or less harmful impact on society. Companies are ranked relative to each other based on their ESG scores, with higher percentiles assigned to companies that achieve higher ESG scores (@kaggleStocksData).

Consider exploring **[this link](https://www.sustainalytics.com/esg-rating/amazon-com-inc/1007896995)** which gives some insight to how the ESG score translates to a company's ranking and thus their percentile by using Amazon.com,Inc. as an example (@sustainalyticsCompanyRisk).


A key limitation of this data set lies in the fact that ESG scores are self-reported, meaning their accuracy depends on the transparency and good faith of the reporting companies. Additionally, the factors and weightings used to calculate ESG scores vary by sector, with each sector placing emphasis on different aspects and assigning varying levels of importance to specific factors. This variation complicates the comparability of ESG scores across sectors, raising questions about the fairness and consistency of such comparison (@greenchoicenowWhatsScore).

# Analysis and Results
Using @R and @RStudio, the following analysis on the dataset @kaggleStocksData has been conducted:


To see top 5% company that with lowest score, and ts.
o explore correlation between score and type of industry 
Within 90th percentile companies, pie chart of percentage each industry in the 90th percentile 
```{r plot1}
##Tina

```

To investigate 3 industries (information technology, healthcare, financial) distributed in which percentile, category into 4, 0-25, 25-50, 50-75, 75-100
grouped Bar plot

This next section seeks to investigate the percentile distribution the of ESG scores of companies within in 3 sectors: Information Technology, Health Care, and Financials. These 3 sectors were chosen because of their similarity in size, with Information Technology having `r nrow(esg.data[esg.data$GICS.Sector =="Information Technology",])` companies, Health Care having `r nrow(esg.data[esg.data$GICS.Sector =="Health Care",])` companies, and Financials having a slightly greater number of `r nrow(esg.data[esg.data$GICS.Sector =="Financials",])`. Additionally, @ggplot2 was used to construct a grouped bar plot.
```{r plot 2}
library(ggplot2)

#creates new column categorizing each entry into quartiles based on their percentile
for (i in 1:nrow(esg.data)){
    
    if (25.0>=esg.data$percentile[i]){
        esg.data$quartiles[i] = "Quartile 1"
    } else if (50>=esg.data$percentile[i]){
        esg.data$quartiles[i] = "Quartile 2"
    } else if (75>=esg.data$percentile[i]){
        esg.data$quartiles[i] = "Quartile 3"
    } else{
        esg.data$quartiles[i] = "Quartile 4"
    }
}
#Creates a subset of esg.data with only the 3 selected sectors

esg.data.industries= data.frame(subset(esg.data, GICS.Sector== "Information Technology"| esg.data$GICS.Sector == "Health Care" | esg.data$GICS.Sector == "Financials"))


industries = c("Information Technology", "Health Care", "Financials")

quartiles = c("Quartile 1","Quartile 2", "Quartile 3","Quartile 4")


heights = vector("numeric",12)
mod.index = 0
for (i in 1:4){
    for (j in 1:3){
        heights[j+mod.index] = nrow(esg.data.industries[esg.data.industries$GICS.Sector == industries[j] & esg.data.industries$quartiles == quartiles[i],])
        
    }
    mod.index = mod.index +3
    
}
# creates new data frame with only necessary data
mod.data = data.frame(Quantity = heights, Sectors = c(industries, industries, industries, industries), Quartiles = rep(quartiles, each =3))

# creates grouped bar plot                      
ggplot(mod.data, aes(fill= Sectors, y= Quantity, x= Quartiles)) +
geom_bar(stat = "identity", position = "dodge") + labs(title = "Quantity of Companies in Select Industries versus Quartile from ESG Score Percentile") + theme(plot.title = element_text(size = 11)) 

```
Within the `r industries[3]` and `r industries[2]` sectors, the distribution is such that there is a maximum reached in Quartile 2, meaning that more companies had ESG scores that were higher than 25% of all companies and lower than 50% of all companies. This differs greatly from the `r industries[1]` sector, where the vast majority of companies had a percentile within the first quartile, meaning that these companies had the lowest ESG scores out of all the companies compared. This could suggest that companies within the `r industries[1]` sector are more conscious of their impact on society. This could also be a reflection of the fact that these companies, such as Amazon and Apple, get more press coverage, and are thus under greater public scrutiny than companies from other sectors. 



Furthermore, the relationship between governance scores and sector is discussed. 
```{r plot 3}
industries = c("Communication Services","Consumer Discretionary", "Consumer Staples", "Energy", "Financials", "Health Care", "Industrials", "Information Technology", "Materials", "Real Estate", "Utilities")

gov.averages = vector("numeric", length(industries))

for (i in 1:length(gov.averages)){
    gov.averages[i] = mean(esg.data$governanceScore[which(esg.data$GICS.Sector == industries[i])])
}

barplot(height = gov.averages, ylim = c(0,10), xlab = "Industries", ylab = "Mean Governance Scores", main = "Mean Governance Scores versus Industry Sector", las = 2, col = colours()[c(3,16,29,46,67,76,91,106,121,136,151)])
legend("topright", col= colours()[c(3,16,29,46,67,76,91,106,121,136,151)], legend = industries, cex = 0.5, pch = 16, ncol = 2)

```
This graph compares the mean governance scores for all sectors included in the @kaggleStocksData data set. The average mean governance score across all sectors is `r mean(gov.averages)`.
It is noted that while most industries had similar governance scores, the `r industries[5]` sector had a significantly greater mean governance score of `r gov.averages[5]`. This suggests that companies within the utilities sector had more concerning corporate governance practices. 



# Conclusion

# Contribution Statement
### Haoran Shi:
Completed Data, the 2nd and 3rd plots and their analyses, and the references.

### Jingyao Zhang:


# References




